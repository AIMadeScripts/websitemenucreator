<!DOCTYPE html>
<html>
  <head>
       <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/themes/prism.css">
       <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/prism.js"></script>    
       <title>Menu Creator</title>
    <meta charset="UTF-8">
        <style>
body {
  font-family: Arial, sans-serif;
  background-color: #4a91ad;
}

h1 {
  text-align: center;
  font-size: 32px;
  margin-top: 50px;
}

label {
  font-size: 20px;
  text-align: center;
  margin-bottom: 10px;
  padding: 10px;
}

label[for="title"],
input[type="text"][id="title"] {
  display: block;
  margin: 0 auto;
  max-width: 500px;
}

input[type=text] {
  padding: 10px;
  text-align: center;
  font-size: 18px;
  border-radius: 10px;
  border: none;
  margin-right: 10px;
  width: 250px;
  box-shadow: 0px 3px 5px rgba(0, 0, 0, 0.1);
}

#menu-options {
  display: flex;
  flex-wrap: wrap;
  text-align: center;
  margin-bottom: 20px;
}

#menu-options label {
  margin-right: 20px;
}

button {
  background-color: #4CAF50;
  border: none;
  color: white;
  padding: 10px;
  text-align: center;
  font-size: 18px;
  border-radius: 10px;
  box-shadow: 0px 3px 5px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: all 0.3s ease;
  margin-right: 10px;
}

button:hover {
  background-color: #3e8e41;
}

textarea,
input[type="text"] {
  background-color: #302c27;
  color: #fff;
  padding: 10px;
  font-size: 18px;
  border-radius: 10px;
  border: none;
  margin-right: 10px;
  width: 100%;
  box-shadow: 0px 3px 5px rgba(0, 0, 0, 0.1);
}

textarea {
  height: 400px;
}
    </style>
  </head>
  <body>
    <h1>Menu Creator</h1>
    <label for="title">Enter a title for your menu: </label><br>
    <input type="text" id="title" name="title"><br><br>
    <div id="menu-options">
      <label for="option">Menu option:</label>
      <input type="text" id="option" name="option">
      <label for="command">Command:</label>
      <input type="text" id="command" name="command">
    </div><br>
    <button onclick="addOption()">Add menu option</button>
    <button onclick="generateScript()">Generate Script</button>
    <button onclick="resetOptions()">Reset options</button>
    <button onclick="copyScript()">Copy Script</button><br><br>
    <form id="menu-form">
      <textarea id="script" class="textarea" rows="20" cols="80"></textarea>
    </form>

    <script>
      var optionCount = 0;
      var options = [];

      function copyScript() {
        var copyText = document.getElementById("script");
        copyText.select();
        document.execCommand("copy");
      }

      function addOption() {
        optionCount++;
        var optionName = document.getElementById("option").value;
        var command = document.getElementById("command").value;
        options.push({ name: optionName, command: command });
        var optionDiv = document.createElement("div");
        optionDiv.setAttribute("id", "optionDiv" + optionCount);
        optionDiv.innerHTML =
          '<label for="option' +
          optionCount +
          '">Menu option:</label>' +
          '<input type="text" id="option' +
          optionCount +
          '" name="option' +
          optionCount +
          '">' +
          '<label for="command' +
          optionCount +
          '">Command:</label>' +
          '<input type="text" id="command' +
          optionCount +
          '" name="command' +
          optionCount +
          '">' +
          '<button id="deleteOption' +
          optionCount +
          '" onclick="deleteOption(' +
          optionCount +
          ')">Delete</button>';
        var optionContainer = document.createElement("div");
        optionContainer.classList.add("option-container");
        optionContainer.appendChild(optionDiv);
        document.getElementById("menu-options").appendChild(optionContainer);
        document.getElementById("option").value = "";
        document.getElementById("command").value = "";
      }
      function deleteOption(optionIndex) {
        options.splice(optionIndex - 1, 1);
        document.getElementById("optionDiv" + optionIndex).remove();
        generateScript(); // regenerate the script
      }
      
      function generateScript() {
          var title = document.getElementById("title").value.trim();
          if (!title) {
              alert("Please enter a title for your menu.");
              return;
          }
          // Retrieve the default option and command inputs
          var defaultOption = document.getElementById("option").value;
          var defaultCommand = document.getElementById("command").value;
          var defaultOption_formatted = defaultOption.replace(/[^a-zA-Z0-9 ]/g, "").replace(/\s+/g, "_");
          var regex = /\$[a-zA-Z0-9]+/g;
          var defaultMatches = defaultCommand.match(regex) || [];
          var inputMatches = [];
          var allMatches = [];
          for (var i = 1; i <= optionCount; i++) {
              var optionName = document.getElementById("option" + i).value;
              var commandInput = document.getElementById("command" + i).value;
              var command = commandInput;
              var optionName_formatted = optionName.replace(/[^a-zA-Z0-9 ]/g, "").replace(/\s+/g, "_");
              inputMatches = inputMatches.concat(commandInput.match(regex) || []);
              script += "def " + optionName_formatted + "():\n";
              script += "    print('You selected " + optionName + "')\n";
              var replacedInput = commandInput.replace(/\$([a-zA-Z0-9]+)/g, '{$1}');
              script += "    " + optionName_formatted + " = f\"" + replacedInput + "\"\n";
              script += "    try:\n";
              script += "        os.system(" + optionName_formatted + ")\n";
              script += "    except KeyboardInterrupt:\n";
              script += "        print('" + optionName + " interrupted by user')\n";
              script += "    input('Press enter to return to menu...')\n\n";
          }
          allMatches = defaultMatches.concat(inputMatches).map(function(match) {
              return match.replace('$', '');
          });
          var uniqueMatches = [...new Set(allMatches)];
          var script = "#!/usr/bin/env python\n\n";
          script += "###===Import Modules Go Here===###\n";
          script += "import os\n\n";
          script += "###===Setting your variables to blank values===###\n";
          if (allMatches.join("")) { // Check if allMatches.join has a value
              script += allMatches.join(" = \"\"\n") + " = \"\"\n";
          }
          script += "###===Separator Function For Pretty Menu===###\n";
          script += "def print_separator():\n";
          script += "    print(\"=\" * 50)\n\n";
          script += "###===Your Viewable Menu===###\n";
          script += "def menu():\n";
          script += "    clear_screen()\n";
          if (title) {
              script += "    print('" + title + "')\n";
          }
          if (uniqueMatches.join("")) { // Check if allMatches.join has a value
              script += "    print('" + "Your script requires these variables to bet set" + " " + uniqueMatches.join(", ") + "')\n";
          }        script += "    print_separator()\n";
        // Include the default option and command in the script
        script += "    print('" + "1. " + defaultOption + "')\n";
        // Loop through the dynamically added menu options and include them in the script
        for (var i = 1; i <= optionCount; i++) {
          var optionName = document.getElementById("option" + i).value;
          var command = document.getElementById("command" + i).value;
          script += "    print('" + (i+1) + ". " + optionName + "')\n";
        }
        if (uniqueMatches.length > 0) { // Check if uniqueMatches has any values
          script += "    ";
          for (var j = 0; j < uniqueMatches.length; j++) {
            script += "print(f'set_" + uniqueMatches[j] + " | Variable currently set as {" + uniqueMatches[j] +"}')\n    ";
            script += "print('(exit) Exit')\n\n";
          }
        } else { // uniqueMatches is empty
          script += "    print('(exit) Exit')\n\n";
        }        script += "###===Making Clear Screen Work On Windows And Linux===###\n";
        script += "def clear_screen():\n";
        script += "    os.system('cls' if os.name == 'nt' else 'clear')\n\n";
        script += "###===When You Choose An Option It Runs One Of These===###\n";
        script += "def " + defaultOption_formatted + "():\n";
        var command = defaultCommand;
        var escapedCommand = "";
        for (var i = 0; i < command.length; i++) {
          var c = command.charAt(i);
          if (c == "\"") {
            escapedCommand += "\\\"";
          } else if (c == "\\") {
            escapedCommand += "\\\\";
          } else {
            escapedCommand += c;
          }
        }        
        script += "    print('You selected " + defaultOption + "')\n";
        script += "    " + defaultOption_formatted + " = f\"" + escapedCommand + "\"\n";
        script += "    try:\n";
        script += "        os.system(" + defaultOption_formatted + ")\n";
        script += "    except KeyboardInterrupt:\n";
        script += "        print('" + defaultOption + " interrupted by user')\n";
        script += "    input('Press enter to return to menu...')\n\n";
        for (var i = 1; i <= optionCount; i++) {
            var optionName = document.getElementById("option" + i).value;
            var commandInput = document.getElementById("command" + i).value;
            var command = commandInput.value;
            var optionName_formatted = optionName.replace(/[^a-zA-Z0-9 ]/g, "").replace(/\s+/g, "_");
            var replacedInput = commandInput.replace(/\$([a-zA-Z0-9]+)/g, '{$1}');
            var command2 = replacedInput;
            var escapedCommand2 = "";
            for (var i = 0; i < command2.length; i++) {
              var c = command2.charAt(i);
              if (c == "\"") {
                escapedCommand2 += "\\\"";
              } else if (c == "\\") {
                escapedCommand2 += "\\\\";
              } else {
                escapedCommand2 += c;
              }
            }        
            script += "def " + optionName_formatted + "():\n";
            script += "    print('You selected " + optionName + "')\n";
            script += "    " + optionName_formatted + " = f\"" + escapedCommand2 + "\"\n";
            script += "    try:\n";
            script += "        os.system(" + optionName_formatted + ")\n";
            script += "    except KeyboardInterrupt:\n";
            script += "        print('" + optionName + " interrupted by user')\n";
            script += "    input('Press enter to return to menu...')\n\n";
        }
        if (uniqueMatches.length > 0) {
          uniqueMatches.forEach((match, index) => {
            script += `def set_${match}():
            global ${match}
            ${match} = input('Enter a new ${match}:')
            input('Press enter to return to menu...')
        `;
            if (index !== uniqueMatches.length - 1) {
              script += '\n';
            }
          });
        }
        script += "\n";
        script += "def exit_menu():\n";
        script += "    print('Goodbye!')\n";
        script += "    exit()\n\n";
        script += "###===Enter Your Choice And Then It Will Activate That Option===###\n";
        script += "if __name__ == '__main__':\n";
        script += "    while True:\n";
        script += "        menu()\n";
        script += "        choice = input('Enter your choice: ')\n";
        // Create an array to hold all of the formatted option names
        var optionNamesFormatted = [];
        
        // Generate the `if` statements for each option
        for (var i = 0; i <= optionCount; i++) {
          var optionName, command;
          if (i == 0) {
            optionName = defaultOption_formatted;
            command = defaultCommand;
          } else {
            optionName = document.getElementById("option" + i).value;
            command = document.getElementById("command" + i).value;
          }
          var optionNameFormatted = optionName.replace(/[^a-zA-Z0-9 ]/g, "").replace(/ /g, "_");
          var defaultOptionFormatted = defaultOption.replace(/[^a-zA-Z0-9 ]/g, "").replace(/\s+/g, "_");
          if (i == 0) {
            optionNameFormatted = defaultOptionFormatted;
          }
          optionNamesFormatted.push(optionNameFormatted);
          script += "        if choice == '" + (i+1) + "':\n";
          script += "            " + optionNameFormatted + "()\n";
        }        
        // Generate the `if` statements for each option
        if (uniqueMatches.length > 0) {
          uniqueMatches.forEach((match, index) => {
            const matchFormatted = match.replace(/[^a-zA-Z0-9]/g, ""); // remove non-alphanumeric characters from match
            script += `        if choice == 'set_${matchFormatted}':\n`;
            script += `            set_${match}()\n`;
          });
        }
        script += "        elif choice.lower() == 'exit':\n";
        script += "            exit_menu()\n";
        script += "        else:\n";
        script += "            print('Invalid choice. Try again.')\n";
        for (var i = 1; i <= optionCount; i++) {
          var optionName = document.getElementById("option" + i).value;
          options.push(optionName);
        }
        document.getElementById("script").value = script;              }

      function resetOptions() {
        // Remove all dynamically added menu option fields
        for (var i = 1; i <= optionCount; i++) {
          document.getElementById("optionDiv" + i).remove();
        }
        // Recreate the original menu option fields
        document.getElementById("menu-options").innerHTML = '<label for="option">Menu option:</label>' +
                                                             '<input type="text" id="option" name="option">' +
                                                             '<label for="command">Command:</label>' +
                                                             '<input type="text" id="command" name="command">';
        optionCount = 0;
        options = [];
        document.getElementById("script").value = ""; // added line
      }      
      </script>
  </body>
</html>
