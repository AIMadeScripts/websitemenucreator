<!DOCTYPE html>
<html>
  <head>
    <title>Menu Creator</title>
    <meta charset="UTF-8">
  </head>
  <body>
    <h1>Menu Creator</h1>
    <label for="title">Enter a title for your menu:</label><br>
    <input type="text" id="title" name="title"><br><br>
    <div id="menu-options">
      <label for="option">Menu option:</label>
      <input type="text" id="option" name="option">
      <label for="command">Command:</label>
      <input type="text" id="command" name="command">
      <button onclick="addOption()">Add menu option</button>
    </div><br>
    <button onclick="generateScript()">Generate Script</button>
    <button onclick="resetOptions()">Reset options</button>
    <button onclick="copyScript()">Copy Script</button><br><br>
    <form id="menu-form">
      <textarea id="script" rows="20" cols="80"></textarea>
    </form>

    <script>
      var optionCount = 0;
      var options = [];

      function copyScript() {
        var copyText = document.getElementById("script");
        copyText.select();
        document.execCommand("copy");
      }

      function addOption() {
        optionCount++;
        var optionName = document.getElementById("option").value;
        var command = document.getElementById("command").value;
        options.push({ name: optionName, command: command });
        var optionDiv = document.createElement("div");
        optionDiv.setAttribute("id", "optionDiv" + optionCount);
        optionDiv.innerHTML = '<label for="option' + optionCount + '">Menu option:</label>' +
                              '<input type="text" id="option' + optionCount + '" name="option' + optionCount + '">' +
                              '<label for="command' + optionCount + '">Command:</label>' +
                              '<input type="text" id="command' + optionCount + '" name="command' + optionCount + '">' +
                              '<button id="deleteOption' + optionCount + '" onclick="deleteOption(' + optionCount + ')">Delete</button>';
        document.getElementById("menu-options").appendChild(optionDiv);
      }

      function deleteOption(optionIndex) {
        options.splice(optionIndex - 1, 1);
        document.getElementById("optionDiv" + optionIndex).remove();
        generateScript(); // regenerate the script
      }
      
      function generateScript() {
        // Retrieve the default option and command inputs
        var defaultOption = document.getElementById("option").value;
        var defaultCommand = document.getElementById("command").value;
        var defaultOption_formatted = defaultOption.replace(/[^a-zA-Z0-9 ]/g, "").replace(/\s+/g, "_");
        var regex = /\$[a-zA-Z0-9]+/g;
        var defaultMatches = defaultCommand.match(regex) || [];
        for (var i = 1; i <= optionCount; i++) {
            var optionName = document.getElementById("option" + i).value;
            var commandInput = document.getElementById("command" + i).value;
            var command = commandInput.value;
            var optionName_formatted = optionName.replace(/[^a-zA-Z0-9 ]/g, "").replace(/\s+/g, "_");
            var inputMatches = commandInput.match(regex) || [];
        }
        var allMatches = defaultMatches.concat(inputMatches).map(function(match) {
          return match.replace('$', '');
        });
        var script = "#!/usr/bin/env python\n\n";
        script += "###===Import Modules Go Here===###\n";
        script += "import os\n\n";
        script += "###===Setting your variables to blank values===###\n";
        if (allMatches.join("")) { // Check if allMatches.join has a value
          script += allMatches.join(" = \"\"\n") + " = \"\"\n";
        }
        script += "###===Separator Function For Pretty Menu===###\n";
        script += "def print_separator():\n";
        script += "    print(\"=\" * 50)\n\n";
        script += "###===Your Viewable Menu===###\n";
        script += "def menu():\n";
        script += "    clear_screen()\n";
        var title = document.getElementById("title").value;
        if (title) {
          script += "    print('" + title + "')\n";
        } 
        if (allMatches.join("")) { // Check if allMatches.join has a value
          script += "    print('" + "" + allMatches.join(", ") + "')\n";
        }
        script += "    print_separator()\n";
        // Include the default option and command in the script
        script += "    print('" + "1. " + defaultOption + "')\n";
        // Loop through the dynamically added menu options and include them in the script
        for (var i = 1; i <= optionCount; i++) {
          var optionName = document.getElementById("option" + i).value;
          var command = document.getElementById("command" + i).value;
          script += "    print('" + (i+1) + ". " + optionName + "')\n";
        }
        script += "    print('(exit) Exit')\n\n";
        script += "###===Making Clear Screen Work On Windows And Linux===###\n";
        script += "def clear_screen():\n";
        script += "    os.system('cls' if os.name == 'nt' else 'clear')\n\n";
        script += "###===When You Choose An Option It Runs One Of These===###\n";
        script += "def " + defaultOption_formatted + "():\n";
        script += "    print('You selected " + defaultOption + "')\n";
        script += "    " + defaultOption_formatted + " = f\"" + defaultCommand + "\"\n";
        script += "    try:\n";
        script += "        os.system(" + defaultOption_formatted + ")\n";
        script += "    except KeyboardInterrupt:\n";
        script += "        print('" + defaultOption + " interrupted by user')\n";
        script += "    input('Press enter to return to menu...')\n\n";
        for (var i = 1; i <= optionCount; i++) {
            var optionName = document.getElementById("option" + i).value;
            var commandInput = document.getElementById("command" + i).value;
            var command = commandInput.value;
            var optionName_formatted = optionName.replace(/[^a-zA-Z0-9 ]/g, "").replace(/\s+/g, "_");
            script += "def " + optionName_formatted + "():\n";
            script += "    print('You selected " + optionName + "')\n";
            script += "    " + optionName_formatted + " = f\"" + commandInput + "\"\n";
            script += "    try:\n";
            script += "        os.system(" + optionName_formatted + ")\n";
            script += "    except KeyboardInterrupt:\n";
            script += "        print('" + optionName + " interrupted by user')\n";
            script += "    input('Press enter to return to menu...')\n\n";
        }
        if (allMatches.length > 0) {
          allMatches.forEach((match, index) => {
            script += `def set_${match}():
            global ${match}
            ${match} = input('Enter a new ${match}:')
            input('Press enter to return to menu...')
        `;
            if (index !== allMatches.length - 1) {
              script += '\n';
            }
          });
        }
        script += "\n";
        script += "def exit_menu():\n";
        script += "    print('Goodbye!')\n";
        script += "    exit()\n\n";
        script += "###===Enter Your Choice And Then It Will Activate That Option===###\n";
        script += "if __name__ == '__main__':\n";
        script += "    while True:\n";
        script += "        menu()\n";
        script += "        choice = input('Enter your choice: ')\n";
        // Create an array to hold all of the formatted option names
        var optionNamesFormatted = [];
        
        // Generate the `if` statements for each option
        for (var i = 0; i <= optionCount; i++) {
          var optionName, command;
          if (i == 0) {
            optionName = defaultOption_formatted;
            command = defaultCommand;
          } else {
            optionName = document.getElementById("option" + i).value;
            command = document.getElementById("command" + i).value;
          }
          var optionNameFormatted = optionName.replace(/[^a-zA-Z0-9 ]/g, "").replace(/ /g, "_");
          var defaultOptionFormatted = defaultOption.replace(/[^a-zA-Z0-9 ]/g, "").replace(/\s+/g, "_");
          if (i == 0) {
            optionNameFormatted = defaultOptionFormatted;
          }
          optionNamesFormatted.push(optionNameFormatted);
          script += "        if choice == '" + (i+1) + "':\n";
          script += "            " + optionNameFormatted + "()\n";
        }        
        if (allMatches.length > 0) {
          allMatches.forEach((match, index) => {
            script += `        if choice == 'set_${match}':
                    set_${match}()\n`;
            if (index !== allMatches.length - 1) {
              script += `        `;
            }
          });
        }
        script += "        elif choice.lower() == 'exit':\n";
        script += "            exit_menu()\n";
        script += "        else:\n";
        script += "            print('Invalid choice. Try again.')\n";
        for (var i = 1; i <= optionCount; i++) {
          var optionName = document.getElementById("option" + i).value;
          options.push(optionName);
        }
        document.getElementById("script").value = script;              }
      function resetOptions() {
        // Remove all dynamically added menu option fields
        for (var i = 1; i <= optionCount; i++) {
          document.getElementById("optionDiv" + i).remove();
        }
      
        // Reset the option count and options array
        optionCount = 0;
        options = [];
      
        // Recreate the original menu option fields
        document.getElementById("menu-options").innerHTML = '<label for="option">Menu option:</label>' +
                                                              '<input type="text" id="option" name="option">' +
                                                              '<label for="command">Command:</label>' +
                                                              '<input type="text" id="command" name="command">' +
                                                              '<button onclick="addOption()">Add menu option</button><br><br>';
      }    
      </script>
  </body>
</html
